<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>E:\porta\projects\faster-multimethods\docs\.changes.md.html</title>


<style type="text/css">
body {
	color: #333;
	font: 13px/1.4 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
	padding: 0;
	margin: 0;
}

a {
	background: transparent;
	color: #4183c4;
	text-decoration: none;
}

a:active,
a:hover {
	outline: 0 none;
	text-decoration: underline;
}

abbr[title] {
	border-bottom: 1px dotted;
}

b,
strong {
	font-weight: bold;
}

dfn {
	font-style: italic;
}
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}
mark {
	background: #ff0;
	color: #000;
}
small {
	font-size: 80%;
}
sub, sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}
sup {
	top: -0.5em;
}
sub {
	bottom: -0.25em;
}
img {
	border: 0 none;
}
svg:not(:root) {
	overflow: hidden;
}
figure {
	margin: 1em 40px;
}
hr {
	box-sizing: content-box;
	height: 0;
}

code,
kbd,
pre,
samp {
	font-family: monospace,monospace;
	font-size: 1em;
}

pre {
	overflow: auto;
	font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
	margin-bottom: 0;
	margin-top: 0;
}

.markdown-body {
	padding: 30px;
	font-size: 16px;
	line-height: 1.6;
	word-wrap: break-word;
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body .absent {
	color: #c00;
}

.markdown-body .anchor {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	display: block;
	padding-right: 6px;
	padding-left: 30px;
	margin-left: -30px;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	position: relative;
	margin-top: 1em;
	margin-bottom: 16px;
	font-weight: bold;
	line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	display: none;
	color: #000;
	vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	padding-left: 8px;
	margin-left: -30px;
	line-height: 1;
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	display: inline-block;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
	font-size: inherit;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2.25em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.75em;
	line-height: 1.225;
	border-bottom: 1px solid #eee;
}

.markdown-body h3 {
	font-size: 1.5em;
	line-height: 1.43;
}

.markdown-body h4 {
	font-size: 1.25em;
}

.markdown-body h5 {
	font-size: 1em;
}

.markdown-body h6 {
	font-size: 1em;
	color: #777;
}

.markdown-body p,.markdown-body blockquote,
.markdown-body ul,.markdown-body ol,
.markdown-body dl,.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 4px;
	padding: 0;
	margin: 16px 0;
	background-color: #e7e7e7;
	border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
	padding: 0;
	list-style-type: none;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: bold;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body blockquote {
	padding: 0 15px;
	color: #777;
	border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
	word-break: normal;
	word-break: keep-all;
}

.markdown-body table th {
	font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #ddd;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f8f8f8;
}

.markdown-body img {
	max-width: 100%;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.markdown-body span.frame {
	display: block;
	overflow: hidden;
}

.markdown-body span.frame>span {
	display: block;
	float: left;
	width: auto;
	padding: 7px;
	margin: 13px 0 0;
	overflow: hidden;
	border: 1px solid #ddd;
}

.markdown-body span.frame span img {
	display: block;
	float: left;
}

.markdown-body span.frame span span {
	display: block;
	padding: 5px 0 0;
	clear: both;
	color: #333;
}

.markdown-body span.align-center {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-center>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: center;
}

.markdown-body span.align-center span img {
	margin: 0 auto;
	text-align: center;
}

.markdown-body span.align-right {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-right>span {
	display: block;
	margin: 13px 0 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body span.align-right span img {
	margin: 0;
	text-align: right;
}

.markdown-body span.float-left {
	display: block;
	float: left;
	margin-right: 13px;
	overflow: hidden;
}

.markdown-body span.float-left span {
	margin: 13px 0 0;
}

.markdown-body span.float-right {
	display: block;
	float: right;
	margin-left: 13px;
	overflow: hidden;
}

.markdown-body span.float-right>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body code,.markdown-body tt {
	padding: 0;
	padding-top: 0.2em;
	padding-bottom: 0.2em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(0,0,0,0.04);
	border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after,
.markdown-body tt:before,
.markdown-body tt:after {
	letter-spacing: -0.2em;
	content: "\00a0";
}

.markdown-body code br,
.markdown-body tt br {
	display: none;
}

.markdown-body del code {
	text-decoration: inherit;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f7f7f7;
	border-radius: 3px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre code,
.markdown-body pre tt {
	display: inline;
	max-width: initial;
	padding: 0;
	margin: 0;
	overflow: initial;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after,
.markdown-body pre tt:before,
.markdown-body pre tt:after {
	content: normal;
}

.highlight .pl-coc,
.highlight .pl-entl,
.highlight .pl-entm,
.highlight .pl-eoa,
.highlight .pl-mai .pl-sf,
.highlight .pl-mm,
.highlight .pl-pdv,
.highlight .pl-sc,
.highlight .pl-som,
.highlight .pl-sr,
.highlight .pl-v,
.highlight .pl-vpf {
	color: #0086b3;
}
.highlight .pl-eoac,
.highlight .pl-mdht,
.highlight .pl-mi1,
.highlight .pl-mri,
.highlight .pl-va,
.highlight .pl-vpu {
	color: #008080;
}
.highlight .pl-c,
.highlight .pl-pdc {
	color: #b4b7b4;
	font-style: italic;
}
.highlight .pl-k,
.highlight .pl-ko,
.highlight .pl-kolp,
.highlight .pl-mc,
.highlight .pl-mr,
.highlight .pl-ms,
.highlight .pl-s,
.highlight .pl-sok,
.highlight .pl-st {
	color: #6e5494;
}
.highlight .pl-ef,
.highlight .pl-enf,
.highlight .pl-enm,
.highlight .pl-entc,
.highlight .pl-eoi,
.highlight .pl-sf,
.highlight .pl-smc {
	color: #d12089;
}
.highlight .pl-ens,
.highlight .pl-eoai,
.highlight .pl-kos,
.highlight .pl-mh .pl-pdh,
.highlight .pl-mp,
.highlight .pl-pde,
.highlight .pl-stp {
	color: #458;
}
.highlight .pl-enti {
	color: #d12089;
	font-weight: bold;
}
.highlight .pl-cce,
.highlight .pl-enc,
.highlight .pl-kou,
.highlight .pl-mq {
	color: #f93;
}
.highlight .pl-mp1 .pl-sf {
	color: #458;
	font-weight: bold;
}
.highlight .pl-cos,
.highlight .pl-ent,
.highlight .pl-md,
.highlight .pl-mdhf,
.highlight .pl-ml,
.highlight .pl-pdc1,
.highlight .pl-pds,
.highlight .pl-s1,
.highlight .pl-scp,
.highlight .pl-sol {
	color: #df5000;
}
.highlight .pl-c1,
.highlight .pl-cn,
.highlight .pl-pse,
.highlight .pl-pse .pl-s2,
.highlight .pl-vi {
	color: #a31515;
}
.highlight .pl-mb,
.highlight .pl-pdb {
	color: #df5000;
	font-weight: bold;
}
.highlight .pl-mi,
.highlight .pl-pdi {
	color: #6e5494;
	font-style: italic;
}
.highlight .pl-ms1 {
	background-color: #f5f5f5;
}
.highlight .pl-mdh,
.highlight .pl-mdi {
	font-weight: bold;
}
.highlight .pl-mdr {
	color: #0086b3;
	font-weight: bold;
}
.highlight .pl-s2 {
	color: #333;
}
.highlight .pl-ii {
	background-color: #df5000;
	color: #fff;
}
.highlight .pl-ib {
	background-color: #f93;
}
.highlight .pl-id {
	background-color: #a31515;
	color: #fff;
}
.highlight .pl-iu {
	background-color: #b4b7b4;
}
.highlight .pl-mo {
	color: #969896;
}

</style>


<script type="text/javascript">

function getDocumentScrollTop() 
{
   var res = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
   // alert(res);
   return res;
}

function setDocumentScrollTop(ypos) 
{
	window.scrollTo(0, ypos);
}

</script>


</head>
<body class="markdown-body">
<h1> <a id="faster-multimethods" class="anchor" href="#faster-multimethods" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>faster-multimethods</h1> 
<h2> <a id="changes-from-clojure-180" class="anchor" href="#changes-from-clojure-180" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Changes from Clojure 1.8.0</h2> 
<h3> <a id="performance-improvements" class="anchor" href="#performance-improvements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Performance improvements</h3> 
<ol> 
 <li> <p>In <a href="https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/MultiFn.java"><code>MultiFn</code></a>, replace <a href="https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/PersistentHashMap.java"><code>PersistentHashMap</code></a> with <a href="https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html"><code>java.util.HashMap</code></a> (<code>hashmaps</code> in the plots).</p> <p>The HashMaps here are treated as immutable, so their behavior is functionally equivalent. However, this requires a fair amount of discipline from all future developers, so is perhaps not the best choice. Experiments with immutable maps from <a href="https://github.com/google/guava">Guava</a> showed essentially the same level of performance, but I prefer not to add such a large dependency to this tiny bit of code. I could include a minimal immutable map implementation, but that would be duplicating work better done elsewhere.</p> <p>The fact that HashMaps perform so much better that PersistentHashMaps, in this context, suggests that there might be opportunities for improving the performance of Clojure collections more generally. Supporting evidence can be seen in <a href="https://github.com/ztellman/clj-tuple">clj-tuple</a> and <a href="https://github.com/ztellman/cambrian-collections">cambrian-collections</a>. See also: <a href="https://www.factual.com/blog/using-clojure-to-generate-java-to-reimplement-clojure">Z. Tellman, Using Clojure To Generate Java To Reimplement Clojure</a>. It is possible that performance improvements to Clojure collections would make this little library unnecessary.</p> </li> 
 <li> <p>Permit more efficient dispatch values (<code>signatures</code> in the plots).</p> <p>I've chosen to add support for an additional special case of dispatch values, which I call Signatures --- essentially short lists of Classes.</p> <p>This is backwards compatible; and can be adopted by changing the dispatch function from, eg, <code>[(class a) (class b)]</code> to <code>(signature a b)</code>.</p> </li> 
 <li> <p>Permit a <code>:hierarchy false</code> option to <code>defmulti</code> (<code>nohierarchy</code> in the plots).</p> <p>Every multimethod (instance of MultiFn) contains a reference to a <code>Var</code> holding a <code>hierarchy</code>. This shared mutable state must be checked for changes every time a multimethod is called.</p> <p>An important special case is one where only classes, and sequences of classes are used as dispatch values. In this case, the hierarchy is irrelevant.</p> <p>Removing the need for synchronizing with the <code>hierarchy</code>, further reduces the overhead.</p> </li> 
</ol> 
<h3> <a id="semantic-changes" class="anchor" href="#semantic-changes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Semantic changes</h3> 
<p>The current implementation is not quite backwards compatible with Clojure 1.8.0, because it fixes 4 issues with how the preferred method is found.</p> 
<p>The first issue is pretty clearly a bug, the remaining might be attributed to different expectations for how the <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L126">dominates</a> partial ordering should behave.</p> 
<ol> 
 <li> <p><a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">MultiFn.prefers()</a> ignores the multimethod's internal hierarchy. This is discussed in <a href="https://dev.clojure.org/jira/browse/CLJ-2234">CLJ-2234</a>, which has a patch submitted. The problem is that <code>prefers</code> calls <code>parents</code> without passing a hierarchy, so it is evaluated relative to the global hierarchy, rather than the multimethod's. faster-multimethods contains unit tests demonstrating the problem in Clojure 1.8.0 and verifying the fix. I plan to raise issues for the 3 remaining, more debatable problems once this one is resolved.</p> </li> 
 <li> <p><a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L161">findAndCacheBestMethod</a> doesn't correctly find the minima of the <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L126">dominates</a> partial ordering. It does a simple reduction of the <code>methodTable</code>, maintaining a single <code>bestEntry</code>. If it encounters an entry that is not strictly ordered, in either direction, relative to the <code>bestEntry</code>, then it throws an exception. However, it's possible for there to be a later entry which would dominate both. What the reduction should do is maintain a set of current minima. If the current entry dominates any elements of the set, then those should be removed. If the current entry is not dominated by any element of the set, then it should be added. I haven't created a unit test for this issue yet, because I'm not sure how to reliably cause a spurious exception to be thrown.</p> <p>The remaining 2 problems could be attributed to differing expectations for the transitivity of the <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L126">dominates</a> relation. My expectation is that <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L126">dominates</a> should be transitive, that is: <code>dominates(x,y)</code> and <code>dominates(y,z)</code> should imply <code>dominates(x,z)</code>.</p> <p>The <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L126">dominates</a> relation is implemented as <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L122">isA</a> extended with <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a>. <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L122">isA</a>, which combines Java inheritance with a Clojure hierarchy, is transitive. <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a>. is not.</p> <p>The documentation for <a href="https://clojure.github.io/clojure/clojure.core-api.html#clojure.core/prefer-method">prefer-method</a> only specifies that <code>(prefer-method f x y)</code> results in methods defined for <code>f</code> for dispatch value <code>x</code> will be preferred to methods for <code>y</code>. One could read this as meaning there is no implied transitivity, so that the only pairs in the <code>prefers</code> relation are those explicitly defined via <code>prefer-method</code>. However, the code doesn't do that either.</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">private</span> <span class="pl-k">boolean</span> prefers(<span class="pl-smi">Object</span> x, <span class="pl-smi">Object</span> y) {
  <span class="pl-smi">IPersistentSet</span> xprefs <span class="pl-k">=</span> (<span class="pl-smi">IPersistentSet</span>) getPreferTable()<span class="pl-k">.</span>valAt(x);
  <span class="pl-k">if</span>(xprefs <span class="pl-k">!=</span> <span class="pl-c1">null</span> <span class="pl-k">&amp;&amp;</span> xprefs<span class="pl-k">.</span>contains(y))
    <span class="pl-k">return</span> <span class="pl-c1">true</span>;
  <span class="pl-k">for</span>(<span class="pl-smi">ISeq</span> ps <span class="pl-k">=</span> <span class="pl-c1">RT</span><span class="pl-k">.</span>seq(parents<span class="pl-k">.</span>invoke(y)); ps <span class="pl-k">!=</span> <span class="pl-c1">null</span>; ps <span class="pl-k">=</span> ps<span class="pl-k">.</span>next())
    {
    <span class="pl-k">if</span>(prefers(x, ps<span class="pl-k">.</span>first()))
      <span class="pl-k">return</span> <span class="pl-c1">true</span>;
    }
  <span class="pl-k">for</span>(<span class="pl-smi">ISeq</span> ps <span class="pl-k">=</span> <span class="pl-c1">RT</span><span class="pl-k">.</span>seq(parents<span class="pl-k">.</span>invoke(x)); ps <span class="pl-k">!=</span> <span class="pl-c1">null</span>; ps <span class="pl-k">=</span> ps<span class="pl-k">.</span>next())
    {
    <span class="pl-k">if</span>(prefers(ps<span class="pl-k">.</span>first(), y))
      <span class="pl-k">return</span> <span class="pl-c1">true</span>;
    }
  <span class="pl-k">return</span> <span class="pl-c1">false</span>;
}</pre>
  </div> <p><a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a> first checks to see if there is an explicit edge on the prefer-method graph for <code>(x,y)</code>. If so, return true. Fine so far.</p> </li> 
 <li> <p>The 2nd step in <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a> essentially iterates over the <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L122">isA</a> ancestors of <code>y</code>, returning true if <code>x</code> is preferred to any ancestor of <code>y</code>. This implies that <code>(prefer-method f x Object)</code> will cause the method for <code>x</code> to be preferred to a method defined for any other Java class or interface <code>y</code>, as long as we don't have <code>isA(x,y)</code>. The fix for this is to just remove the first <code>for</code> loop from <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a>. faster-multimethods contains a unit test demonstrating the behavior of Clojure 1.8.0 and verifying the fix.</p> <p>The 3rd step in <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a> checks to see if any <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L122">isA</a> ancestor of <code>x</code> is preferred to <code>y</code>. In this way, <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a> inherits the transitivity of <a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L122">isA</a>. This is correct.</p> </li> 
 <li> <p><a href="https://github.com/clojure/clojure/blob/clojure-1.8.0/src/jvm/clojure/lang/MultiFn.java#L105">prefers</a> is missing the search needed to be completely transitive. It needs to check all the keys <code>k</code> of the <code>preferTable</code>, returning true if <code>prefers(x,k)</code> and <code>prefers(k,y)</code>. faster-multimethod contains a unit test demonstrating the non-transitivity of Clojure 1.8.0, and verifying the transitivity of its own implementation.</p> </li> 
</ol> 
<h2> <a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2> 
<h3> <a id="dependency" class="anchor" href="#dependency" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependency</h3> 
<h4> <a id="maven" class="anchor" href="#maven" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Maven:</h4> 
<div class="highlight highlight-text-xml">
 <pre>&lt;<span class="pl-ent">dependency</span>&gt;
  &lt;<span class="pl-ent">groupId</span>&gt;palisades-lakes&lt;/<span class="pl-ent">groupId</span>&gt;
  &lt;<span class="pl-ent">artifactId</span>&gt;faster-multimethods&lt;/<span class="pl-ent">artifactId</span>&gt;
  &lt;<span class="pl-ent">version</span>&gt;0.1.0&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
</div> 
<h4> <a id="leiningenboot" class="anchor" href="#leiningenboot" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Leiningen/Boot:</h4> 
<div class="highlight highlight-source-clojure">
 <pre>[palisades-lakes/faster-multimethods <span class="pl-s"><span class="pl-pds">&quot;</span>0.1.0<span class="pl-pds">&quot;</span></span>]</pre>
</div> 
<h3> <a id="code-examples" class="anchor" href="#code-examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Code examples</h3> 
<h4> <a id="fastest" class="anchor" href="#fastest" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Fastest:</h4> 
<div class="highlight highlight-source-clojure">
 <pre>(<span class="pl-k">require</span> `[palisades.lakes.multimethods.core <span class="pl-c1">:as</span> plm])

(<span class="pl-k">plm/defmulti</span> <span class="pl-e">intersects?</span>
  <span class="pl-s"><span class="pl-pds">&quot;</span>Test for general set intersection.<span class="pl-pds">&quot;</span></span>
  {}  
  (<span class="pl-k">fn</span> intersects?-dispatch [s0 s1] (<span class="pl-en">plm/extract-signature</span> s0 s1))
  
  <span class="pl-c1">:hierarchy</span> <span class="pl-c1">false</span>)
  
(<span class="pl-k">plm/defmethod</span> <span class="pl-e">intersects?</span> 
  (<span class="pl-en">plm/signature</span> IntegerInterval java.util.Set)
  [^IntegerInterval s0 ^java.util.Set s1]
  (<span class="pl-en">.intersects</span> s0 s1))
  
...</pre>
</div> 
<h4> <a id="most-general" class="anchor" href="#most-general" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Most general:</h4> 
<div class="highlight highlight-source-clojure">
 <pre>(<span class="pl-k">require</span> `[palisades.lakes.multimethods.core <span class="pl-c1">:as</span> plm])

(<span class="pl-k">plm/defmulti</span> <span class="pl-e">intersects?</span>
  <span class="pl-s"><span class="pl-pds">&quot;</span>Test for general set intersection.<span class="pl-pds">&quot;</span></span>
  
  {}  
  
  (<span class="pl-k">fn</span> intersects?-dispatch [s0 s1] [(<span class="pl-en">class</span> s0) (<span class="pl-en">class</span> s1))))
  
(<span class="pl-k">plm/defmethod</span> <span class="pl-e">intersects?</span> 
  [IntegerInterval java.util.Set]
  [^IntegerInterval s0 ^java.util.Set s1]
  (<span class="pl-en">some</span> #(<span class="pl-en">.contains</span> s0 %) s1))
  
...</pre>
</div> 
<h2> <a id="acknowledgments" class="anchor" href="#acknowledgments" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Acknowledgments</h2> 
<h3> <a id="" class="anchor" href="#" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://camo.githubusercontent.com/97fa03cac759a772255b93c64ab1c9f76a103681/68747470733a2f2f7777772e796f75726b69742e636f6d2f696d616765732f796b6c6f676f2e706e67" target="_blank"><img src="https://camo.githubusercontent.com/97fa03cac759a772255b93c64ab1c9f76a103681/68747470733a2f2f7777772e796f75726b69742e636f6d2f696d616765732f796b6c6f676f2e706e67" alt="Yourkit" data-canonical-src="https://www.yourkit.com/images/yklogo.png" style="max-width:100%;" /></a> </h3> 
<p>YourKit is kindly supporting open source projects with its full-featured Java Profiler.</p> 
<p>YourKit, LLC is the creator of innovative and intelligent tools for profiling Java and .NET applications. Take a look at YourKit's leading software products:</p> 
<ul> 
 <li> <a href="http://www.yourkit.com/java/profiler/index.jsp">YourKit Java Profiler</a> and</li> 
 <li> <a href="http://www.yourkit.com/.net/profiler/index.jsp">YourKit .NET Profiler</a>.</li> 
</ul>
</body>
</html>
